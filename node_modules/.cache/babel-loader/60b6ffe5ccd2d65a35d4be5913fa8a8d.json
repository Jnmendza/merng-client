{"ast":null,"code":"var _jsxFileName = \"/Users/jonathanmendoza/Desktop/merng-client/src/components/DeleteButton.js\";\nimport React, { useState } from 'react';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { Button, Confirm, Icon } from 'semantic-ui-react';\nimport { FETCH_POSTS_QUERY } from '../util/graphql';\nimport MyPopup from '../util/MyPopup';\n\nfunction DeleteButton({\n  postId,\n  commentId,\n  callback\n}) {\n  const [confirmOpen, setConfirmOpen] = useState(false);\n  const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n  const [deletePostOrMutation] = useMutation(mutation, {\n    update(proxy) {\n      setConfirmOpen(false);\n\n      if (!commentId) {\n        const data = proxy.readQuery({\n          query: FETCH_POSTS_QUERY\n        });\n        data.getPosts = data.getPosts.filter(p => p.id !== postId);\n        proxy.writeQuery({\n          query: FETCH_POSTS_QUERY,\n          data\n        });\n      }\n\n      if (callback) callback();\n    },\n\n    variables: {\n      postId,\n      commentId\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MyPopup, {\n    content: commentId ? 'Delete comment' : 'Delete post',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    as: \"div\",\n    color: \"red\",\n    floated: \"right\",\n    onClick: () => setConfirmOpen(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"trash\",\n    style: {\n      margin: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(Confirm, {\n    open: confirmOpen,\n    onCancel: () => setConfirmOpen(false),\n    onConfirm: deletePostOrMutation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }\n  }));\n}\n\nconst DELETE_POST_MUTATION = gql`\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n`;\nconst DELETE_COMMENT_MUTATION = gql`\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n`;\nexport default DeleteButton;","map":{"version":3,"sources":["/Users/jonathanmendoza/Desktop/merng-client/src/components/DeleteButton.js"],"names":["React","useState","gql","useMutation","Button","Confirm","Icon","FETCH_POSTS_QUERY","MyPopup","DeleteButton","postId","commentId","callback","confirmOpen","setConfirmOpen","mutation","DELETE_COMMENT_MUTATION","DELETE_POST_MUTATION","deletePostOrMutation","update","proxy","data","readQuery","query","getPosts","filter","p","id","writeQuery","variables","margin"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAASC,WAAT,QAA4B,qBAA5B;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,IAA1B,QAAsC,mBAAtC;AAEA,SAASC,iBAAT,QAAkC,iBAAlC;AACA,OAAOC,OAAP,MAAoB,iBAApB;;AAEA,SAASC,YAAT,CAAsB;AAAEC,EAAAA,MAAF;AAAUC,EAAAA,SAAV;AAAqBC,EAAAA;AAArB,CAAtB,EAAuD;AACrD,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCb,QAAQ,CAAC,KAAD,CAA9C;AAEA,QAAMc,QAAQ,GAAGJ,SAAS,GAAGK,uBAAH,GAA6BC,oBAAvD;AAEA,QAAM,CAACC,oBAAD,IAAyBf,WAAW,CAACY,QAAD,EAAW;AACnDI,IAAAA,MAAM,CAACC,KAAD,EAAQ;AACZN,MAAAA,cAAc,CAAC,KAAD,CAAd;;AACA,UAAI,CAACH,SAAL,EAAgB;AACd,cAAMU,IAAI,GAAGD,KAAK,CAACE,SAAN,CAAgB;AAC3BC,UAAAA,KAAK,EAAEhB;AADoB,SAAhB,CAAb;AAGAc,QAAAA,IAAI,CAACG,QAAL,GAAgBH,IAAI,CAACG,QAAL,CAAcC,MAAd,CAAsBC,CAAD,IAAOA,CAAC,CAACC,EAAF,KAASjB,MAArC,CAAhB;AACAU,QAAAA,KAAK,CAACQ,UAAN,CAAiB;AAAEL,UAAAA,KAAK,EAAEhB,iBAAT;AAA4Bc,UAAAA;AAA5B,SAAjB;AACD;;AACD,UAAIT,QAAJ,EAAcA,QAAQ;AACvB,KAXkD;;AAYnDiB,IAAAA,SAAS,EAAE;AACTnB,MAAAA,MADS;AAETC,MAAAA;AAFS;AAZwC,GAAX,CAA1C;AAiBA,sBACE,uDACE,oBAAC,OAAD;AAAS,IAAA,OAAO,EAAEA,SAAS,GAAG,gBAAH,GAAsB,aAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,EAAE,EAAC,KADL;AAEE,IAAA,KAAK,EAAC,KAFR;AAGE,IAAA,OAAO,EAAC,OAHV;AAIE,IAAA,OAAO,EAAE,MAAMG,cAAc,CAAC,IAAD,CAJ/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAME,oBAAC,IAAD;AAAM,IAAA,IAAI,EAAC,OAAX;AAAmB,IAAA,KAAK,EAAE;AAAEgB,MAAAA,MAAM,EAAE;AAAV,KAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CADF,CADF,eAWE,oBAAC,OAAD;AACE,IAAA,IAAI,EAAEjB,WADR;AAEE,IAAA,QAAQ,EAAE,MAAMC,cAAc,CAAC,KAAD,CAFhC;AAGE,IAAA,SAAS,EAAEI,oBAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXF,CADF;AAmBD;;AAED,MAAMD,oBAAoB,GAAGf,GAAI;AACjC;AACA;AACA;AACA,CAJA;AAMA,MAAMc,uBAAuB,GAAGd,GAAI;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAbA;AAeA,eAAeO,YAAf","sourcesContent":["import React, { useState } from 'react';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { Button, Confirm, Icon } from 'semantic-ui-react';\n\nimport { FETCH_POSTS_QUERY } from '../util/graphql';\nimport MyPopup from '../util/MyPopup';\n\nfunction DeleteButton({ postId, commentId, callback }) {\n  const [confirmOpen, setConfirmOpen] = useState(false);\n\n  const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n\n  const [deletePostOrMutation] = useMutation(mutation, {\n    update(proxy) {\n      setConfirmOpen(false);\n      if (!commentId) {\n        const data = proxy.readQuery({\n          query: FETCH_POSTS_QUERY\n        });\n        data.getPosts = data.getPosts.filter((p) => p.id !== postId);\n        proxy.writeQuery({ query: FETCH_POSTS_QUERY, data });\n      }\n      if (callback) callback();\n    },\n    variables: {\n      postId,\n      commentId\n    }\n  });\n  return (\n    <>\n      <MyPopup content={commentId ? 'Delete comment' : 'Delete post'}>\n        <Button\n          as=\"div\"\n          color=\"red\"\n          floated=\"right\"\n          onClick={() => setConfirmOpen(true)}\n        >\n          <Icon name=\"trash\" style={{ margin: 0 }} />\n        </Button>\n      </MyPopup>\n      <Confirm\n        open={confirmOpen}\n        onCancel={() => setConfirmOpen(false)}\n        onConfirm={deletePostOrMutation}\n      />\n    </>\n  );\n}\n\nconst DELETE_POST_MUTATION = gql`\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n`;\n\nconst DELETE_COMMENT_MUTATION = gql`\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n`;\n\nexport default DeleteButton;"]},"metadata":{},"sourceType":"module"}